<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soccer Hut</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f4f4f4;
            margin: 0;
            padding: 20px;
        }

        h1 {
            font-size: 3em;
            color: #333;
        }

        canvas {
            background-color: green;
            display: block;
            margin: 20px auto;
            border: 5px solid #fff;
        }

        #controls {
            margin-top: 20px;
        }

        button {
            padding: 10px 20px;
            font-size: 16px;
            margin: 5px;
            cursor: pointer;
        }

        #shop {
            margin-top: 20px;
            display: flex;
            justify-content: center;
        }

        .shop-item {
            border: 1px solid #ccc;
            padding: 10px;
            margin: 10px;
            text-align: center;
            background-color: #f9f9f9;
            width: 150px;
        }

        .shop-item img {
            width: 100%;
            height: auto;
        }

        .credits {
            font-size: 12px;
            color: gray;
            margin-top: 20px;
        }

        #teamSelection, #shopScreen, #gameScreen {
            display: none;
        }
    </style>
</head>
<body>

    <h1>Soccer Hut</h1>

    <div id="loginScreen">
        <h2>Login to Play</h2>
        <input type="text" id="username" placeholder="Username"><br><br>
        <input type="password" id="password" placeholder="Password"><br><br>
        <button onclick="login()">Login</button>
    </div>

    <div id="teamSelection">
        <h2>Select a Team to Play Against</h2>
        <select id="teamChoice">
            <option value="Team 1">Team 1</option>
            <option value="Team 2">Team 2</option>
            <option value="Team 3">Team 3</option>
        </select><br><br>
        <button onclick="startMatch()">Start Match</button>
        <button onclick="openShop()">Go to Shop</button>
    </div>

    <div id="shopScreen">
        <h2>Shop - Buy Players</h2>
        <div id="hutCoinsDisplay">Hut Coins: 0</div>
        <div id="shop">
            <div class="shop-item">
                <img src="https://via.placeholder.com/100" alt="Player 1">
                <h3>Player 1</h3>
                <p>Price: 100 Hut Coins</p>
                <button onclick="buyPlayer(100)">Buy</button>
            </div>
            <div class="shop-item">
                <img src="https://via.placeholder.com/100" alt="Player 2">
                <h3>Player 2</h3>
                <p>Price: 200 Hut Coins</p>
                <button onclick="buyPlayer(200)">Buy</button>
            </div>
            <div class="shop-item">
                <img src="https://via.placeholder.com/100" alt="Player 3">
                <h3>Player 3</h3>
                <p>Price: 300 Hut Coins</p>
                <button onclick="buyPlayer(300)">Buy</button>
            </div>
        </div>
        <br>
        <button onclick="goBackToTeamSelection()">Back to Team Selection</button>
    </div>

    <div id="gameScreen">
        <canvas id="soccerField" width="800" height="400"></canvas>
        <div id="controls">
            <button onclick="play()">Play Match</button>
            <button onclick="resetGame()">Reset Game</button>
        </div>
    </div>

    <div class="credits">
        <p>Vihaan Bhatt, Aranya Chatterjee, Viaan Bahl, and Ryan Chindu</p>
    </div>

    <script>
        // Variables for game and shop
        let hutCoins = 0;
        let playerInventory = [];
        let isLoggedIn = false;
        let isOwner = false;

        const canvas = document.getElementById("soccerField");
        const ctx = canvas.getContext("2d");

        // Hide everything except login screen initially
        document.getElementById('loginScreen').style.display = 'block';

        // Predefined users with their passwords
        const users = [
            { username: 'l', password: 'm', isOwner: false },  // Predefined user
        ];

        // Check if 3 owners exist already
        let ownerCount = localStorage.getItem('ownerCount') ? parseInt(localStorage.getItem('ownerCount')) : 0;

        // Function to handle login
        function login() {
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;

            // Check if user already exists
            let user = users.find(user => user.username === username && user.password === password);

            if (!user) {
                // Register new user
                if (ownerCount < 3) {
                    isOwner = true;
                    ownerCount++;
                    localStorage.setItem('ownerCount', ownerCount);
                    alert("You are an Owner with infinite Hut Coins!");
                } else {
                    isOwner = false;
                    alert("You are a regular player.");
                }

                user = { username, password, isOwner };
                users.push(user);
            } else {
                isOwner = user.isOwner;
                alert(isOwner ? "Welcome back, Owner!" : "Welcome back!");
            }

            isLoggedIn = true;
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('teamSelection').style.display = 'block';

            // Load user data (if any exists)
            loadUserData();
        }

        // Function to load user data (using localStorage for simulation)
        function loadUserData() {
            const savedHutCoins = localStorage.getItem('hutCoins');
            const savedInventory = localStorage.getItem('playerInventory');

            if (savedHutCoins && !isOwner) {
                hutCoins = parseInt(savedHutCoins);
                document.getElementById('hutCoinsDisplay').innerText = "Hut Coins: " + hutCoins;
            } else if (isOwner) {
                hutCoins = Infinity; // Infinite Hut Coins for owners
                document.getElementById('hutCoinsDisplay').innerText = "Hut Coins: Infinite";
            }

            if (savedInventory) {
                playerInventory = JSON.parse(savedInventory);
            }
        }

        // Function to start match
        function startMatch() {
            const teamChoice = document.getElementById('teamChoice').value;
            document.getElementById('teamSelection').style.display = 'none';
            document.getElementById('gameScreen').style.display = 'block';
            // Setup the game logic for the chosen team
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = "green";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = "white";
            ctx.fillText(`Playing against ${teamChoice}`, 350, 200);
        }

        // Function to play match and earn Hut Coins
        function play() {
            if (!isOwner) {
                alert("You played a match! +50 Hut Coins");
                hutCoins += 50;
                updateHutCoinsDisplay();
                saveUserData();
            } else {
                alert("You are an Owner and have infinite Hut Coins!");
            }
        }

        // Function to reset the game
        function resetGame() {
            if (!isOwner) {
                hutCoins = 0;
                playerInventory = [];
                updateHutCoinsDisplay();
                saveUserData();
                alert("Game reset");
            } else {
                alert("Owners cannot reset their Hut Coins, as they are infinite!");
            }
        }

        // Function to update the Hut Coins display
        function updateHutCoinsDisplay() {
            document.getElementById('hutCoinsDisplay').innerText = "Hut Coins: " + (isOwner ? "Infinite" : hutCoins);
        }

        // Function to buy players
        function buyPlayer(price) {
            if (isOwner || hutCoins >= price) {
                if (!isOwner) hutCoins -= price;
                playerInventory.push(`Player ${price}`);
                alert(`You bought a player for ${price} Hut Coins`);
                updateHutCoinsDisplay();
                saveUserData();
            } else {
                alert("Not enough Hut Coins!");
            }
        }

        // Function to open the shop
        function openShop() {
            document.getElementById('teamSelection').style.display = 'none';
            document.getElementById('shopScreen').style.display = 'block';
        }

        // Function to go back to team selection from the shop
        function goBackToTeamSelection() {
            document.getElementById('shopScreen').style.display = 'none';
            document.getElementById('teamSelection').style.display = 'block';
        }

        // Function to save user data in localStorage
        function saveUserData() {
            if (!isOwner) {
                localStorage.setItem('hutCoins', hutCoins);
            }
            localStorage.setItem('playerInventory', JSON.stringify(playerInventory));
        }
    </script>
</body>
</html>
